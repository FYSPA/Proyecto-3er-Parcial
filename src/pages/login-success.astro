---
const userId = Astro.url.searchParams.get("user");
const nombre = Astro.url.searchParams.get("nombre");
const correo = Astro.url.searchParams.get("correo");

if (!userId) {
    return Astro.redirect("/LoginRegisterPages/loginPage");
}
---

<html lang="es">
    <head>
        <meta charset="UTF-8" />
        <title>Login Exitoso</title>
    </head>
    <body>
        <h1>Login Successful</h1>
        <p>Redirigiendo a mainPage...</p>

        <script type="text/javascript">
            const userId = new URLSearchParams(window.location.search).get(
                "user",
            );
            const nombre = new URLSearchParams(window.location.search).get(
                "nombre",
            );
            const correo = new URLSearchParams(window.location.search).get(
                "correo",
            );

            if (userId) {
                // Guardar en localStorage
                localStorage.setItem("user_id", userId);
                localStorage.setItem("user_nombre", nombre);
                localStorage.setItem("user_correo", correo);
                localStorage.setItem("logged_in", "true");

                setTimeout(() => {
                    window.location.href = "/dashboardpage/Dashboard";
                }, 500);
            } else {
                window.location.href = "/LoginRegisterPages/loginPage";
            }
        </script>
    </body>
</html>
