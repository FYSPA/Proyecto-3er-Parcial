<!doctype html>
<html lang="es">
    <head>
        <meta charset="UTF-8" />
        <title>Qr Login</title>
        <link rel="icon" href="/logoVGS.ico" />
        <style>
            .spinner {
                width: 50px;
                height: 50px;
                border: 4px solid rgba(0, 0, 0, 0.2);
                border-top-color: #3498db;
                border-radius: 50%;
                animation: spin 0.8s linear infinite;
            }

            @keyframes spin {
                to {
                    transform: rotate(360deg);
                }
            }

            body {
                display: flex;
                justify-content: center;
                align-items: center;
                min-height: 100vh;
                flex-direction: column;
                gap: 10px;
                overflow-y: hidden;
                font-size: 20px;
            }
            #spinnerBox {
                display: none;
                display: flex;
                justify-content: center;
                align-items: center;
                flex-direction: column;
            }
            #message {
                font-size: 18px;
                margin-top: 10px;
            }
        </style>
    </head>
    <body>
        <div id="spinnerBox">
            <div class="spinner"></div>
            <span>Cargando...</span>
        </div>

        <div id="message"></div>

        <script is:inline>
            async function doFetch() {
                const spinnerBox = document.getElementById("spinnerBox");
                const msg = document.getElementById("message");
                msg.textContent = "";
                spinnerBox.style.display = "flex";

                const formData = new FormData();
                formData.append("exampleKey", "exampleValue");

                try {
                    const apiUrl =
                        window.PUBLIC_API_URL || "http://localhost:8000";
                    const res = await fetch(`${apiUrl}/login.php`, {
                        method: "POST",
                        body: formData,
                    });
                    const json = await res.json();
                    msg.style.color = json.success ? "green" : "red";
                    msg.textContent = json.success
                        ? "¡Operación exitosa!"
                        : "Error: " +
                          (json.message || "Respuesta fallida del servidor");
                } catch (err) {
                    msg.style.color = "red";
                    msg.textContent = "Error en la petición: " + err.message;
                } finally {
                    spinnerBox.style.display = "none";
                }
            }

            doFetch();
        </script>
    </body>
</html>
